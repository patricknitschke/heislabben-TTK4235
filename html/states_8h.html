<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elevator lab - TTK4235: source/states.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elevator lab - TTK4235
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">states.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>State definitions and its corresponding functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="elevator_8h_source.html">elevator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="queue_8h_source.html">queue.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lights_8h_source.html">lights.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="door_8h_source.html">door.h</a>&quot;</code><br />
</div>
<p><a href="states_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac6d9f440e9d1e6bbc948c13ed7cdccd7"><td class="memItemLeft" align="right" valign="top"><a id="ac6d9f440e9d1e6bbc948c13ed7cdccd7"></a>
typedef enum <a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abf">tag_state</a>&#160;</td><td class="memItemRight" valign="bottom"><b>state</b></td></tr>
<tr class="separator:ac6d9f440e9d1e6bbc948c13ed7cdccd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2af5bc6b2437cab9b3dd701744368abf"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abf">tag_state</a> { <br />
&#160;&#160;<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfac169e9ffa53b0e66f7f30d192d44643f">START</a>, 
<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfa051fbc8606b854603fe93508651dac2c">IDLE</a>, 
<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfa7ee2de6c753618ca9b6ed035e1b72fa7">DRIVING</a>, 
<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfacebb89aafa9389b3ed8828e7e4d0a585">PICKUP</a>, 
<br />
&#160;&#160;<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfa22114f46a3d4d4dc2abf05ab8b7e5c03">EMERGENCY</a>, 
<a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abfa1de54bd922161dd5c6a353647f448fd6">END</a>
<br />
 }</td></tr>
<tr class="separator:a2af5bc6b2437cab9b3dd701744368abf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef6441779abf5c61cf7d756abd088bce"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#aef6441779abf5c61cf7d756abd088bce">state_pending_emergency</a> (state current_state)</td></tr>
<tr class="memdesc:aef6441779abf5c61cf7d756abd088bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transitions the FSM to an emergency state if the stop button pressed.  <a href="#aef6441779abf5c61cf7d756abd088bce">More...</a><br /></td></tr>
<tr class="separator:aef6441779abf5c61cf7d756abd088bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc53252d6deea62ee6029e971f5087a"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a0bc53252d6deea62ee6029e971f5087a">state_start</a> (void)</td></tr>
<tr class="memdesc:a0bc53252d6deea62ee6029e971f5087a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises elevator, queue and door modules.  <a href="#a0bc53252d6deea62ee6029e971f5087a">More...</a><br /></td></tr>
<tr class="separator:a0bc53252d6deea62ee6029e971f5087a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170cb59be6707eea55c4e41cd75ec225"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a170cb59be6707eea55c4e41cd75ec225">state_idle</a> (void)</td></tr>
<tr class="memdesc:a170cb59be6707eea55c4e41cd75ec225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does nothing. Stays in IDLE if the queue is empty, transition to DRIVING otherwise.  <a href="#a170cb59be6707eea55c4e41cd75ec225">More...</a><br /></td></tr>
<tr class="separator:a170cb59be6707eea55c4e41cd75ec225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5b17293a7966a3e5e7bd4de1efe2eb"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#aee5b17293a7966a3e5e7bd4de1efe2eb">state_driving</a> (void)</td></tr>
<tr class="memdesc:aee5b17293a7966a3e5e7bd4de1efe2eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continuously drives towards the elevator target.  <a href="#aee5b17293a7966a3e5e7bd4de1efe2eb">More...</a><br /></td></tr>
<tr class="separator:aee5b17293a7966a3e5e7bd4de1efe2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cfe686c0dd1623de8f3fa7255c47841"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a4cfe686c0dd1623de8f3fa7255c47841">state_pickup</a> (void)</td></tr>
<tr class="memdesc:a4cfe686c0dd1623de8f3fa7255c47841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controls the door using a timer.  <a href="#a4cfe686c0dd1623de8f3fa7255c47841">More...</a><br /></td></tr>
<tr class="separator:a4cfe686c0dd1623de8f3fa7255c47841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0c6077def6202b9730114a4543caad"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#add0c6077def6202b9730114a4543caad">state_emergency</a> (void)</td></tr>
<tr class="memdesc:add0c6077def6202b9730114a4543caad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops the motor and empties the queue. Elevator waits until emergency over.  <a href="#add0c6077def6202b9730114a4543caad">More...</a><br /></td></tr>
<tr class="separator:add0c6077def6202b9730114a4543caad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5a0983f3a289493459ed1c632cb480c"><td class="memItemLeft" align="right" valign="top">state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#af5a0983f3a289493459ed1c632cb480c">state_end</a> (void)</td></tr>
<tr class="memdesc:af5a0983f3a289493459ed1c632cb480c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exits the FSM.  <a href="#af5a0983f3a289493459ed1c632cb480c">More...</a><br /></td></tr>
<tr class="separator:af5a0983f3a289493459ed1c632cb480c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>State definitions and its corresponding functions. </p>
<p>This file contains the necessary states to implement a functioning elevator. </p>

<p class="definition">Definition in file <a class="el" href="states_8h_source.html">states.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2af5bc6b2437cab9b3dd701744368abf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2af5bc6b2437cab9b3dd701744368abf">&#9670;&nbsp;</a></span>tag_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="states_8h.html#a2af5bc6b2437cab9b3dd701744368abf">tag_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>State tags used in the finite state machine (FSM). These brief descriptions are elaborated further in their respective state functions. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfac169e9ffa53b0e66f7f30d192d44643f"></a>START&#160;</td><td class="fielddoc"><p>State where the initialisation of the elevator occurs. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfa051fbc8606b854603fe93508651dac2c"></a>IDLE&#160;</td><td class="fielddoc"><p>State where the elevator idles whilst waiting for an order. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfa7ee2de6c753618ca9b6ed035e1b72fa7"></a>DRIVING&#160;</td><td class="fielddoc"><p>State where the elevator is in motion, attempting to reach a target. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfacebb89aafa9389b3ed8828e7e4d0a585"></a>PICKUP&#160;</td><td class="fielddoc"><p>State when the elevator stops to serve a customer and doors are controlled. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfa22114f46a3d4d4dc2abf05ab8b7e5c03"></a>EMERGENCY&#160;</td><td class="fielddoc"><p>State when the stop button is pressed and handled according to specific standards. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2af5bc6b2437cab9b3dd701744368abfa1de54bd922161dd5c6a353647f448fd6"></a>END&#160;</td><td class="fielddoc"><p>State which signifies that the FSM stops. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="states_8h_source.html#l00037">37</a> of file <a class="el" href="states_8h_source.html">states.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aee5b17293a7966a3e5e7bd4de1efe2eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee5b17293a7966a3e5e7bd4de1efe2eb">&#9670;&nbsp;</a></span>state_driving()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_driving </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continuously drives towards the elevator target. </p>
<p>The elevator's floor and direction is continuously set to reach a defined target. Once a target is reached or there is an order in the same direction, the FSM transitions to PICKUP.</p>
<dl class="section return"><dt>Returns</dt><dd>PICKUP on reaching a floor with an appropriate order. Otherwise, returns DRIVING. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="queue_8h.html#a6246a25fc3b07b678c031c3dd798e077" title="Identifies when to serve a customer and serves a customer if certain conditions are met.">queue_stop_n_serve_order</a> for details on what is an appropriate order. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00033">33</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="add0c6077def6202b9730114a4543caad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add0c6077def6202b9730114a4543caad">&#9670;&nbsp;</a></span>state_emergency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_emergency </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops the motor and empties the queue. Elevator waits until emergency over. </p>
<p>All queue orders are removed and all lights are turned off. Also, if on a valid floor, the doors are opened. Then, the elevator will stay in a 'busy' wait as long as the stop button is pressed.</p>
<dl class="section return"><dt>Returns</dt><dd>PICKUP when the elevator is on a valid floor. IDLE otherwise. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the doors are open, the doors remain open until after 3 seconds have passed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00064">64</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="af5a0983f3a289493459ed1c632cb480c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5a0983f3a289493459ed1c632cb480c">&#9670;&nbsp;</a></span>state_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_end </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exits the FSM. </p>
<p>The criteria in the while loop that runs the FSM fails, thus exiting the FSM. See <a class="el" href="main_8c_source.html">main.c</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>END. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00084">84</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="a170cb59be6707eea55c4e41cd75ec225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a170cb59be6707eea55c4e41cd75ec225">&#9670;&nbsp;</a></span>state_idle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_idle </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does nothing. Stays in IDLE if the queue is empty, transition to DRIVING otherwise. </p>
<dl class="section return"><dt>Returns</dt><dd>DRIVING if the queue is not empty, i.e. an order is pending. Otherwise, returns IDLE. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00024">24</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="aef6441779abf5c61cf7d756abd088bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef6441779abf5c61cf7d756abd088bce">&#9670;&nbsp;</a></span>state_pending_emergency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_pending_emergency </td>
          <td>(</td>
          <td class="paramtype">state&#160;</td>
          <td class="paramname"><em>current_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transitions the FSM to an emergency state if the stop button pressed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_state</td><td>State that FSM currently is in. Used to maintain state. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EMERGENCY state if the stop button is pressed, <code>current_state</code> if not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00003">3</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="a4cfe686c0dd1623de8f3fa7255c47841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cfe686c0dd1623de8f3fa7255c47841">&#9670;&nbsp;</a></span>state_pickup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_pickup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controls the door using a timer. </p>
<p>Stops the motor and starts a timer of 3 seconds. Once the customer has entered (after 3 seconds), the FSM will transition to IDLE if there are no other orders, or DRIVING if there are.</p>
<dl class="section return"><dt>Returns</dt><dd>PICKUP while the timer is ongoing. Otherwise, IDLE if the queue is empty or DRIVING if not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00046">46</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
<a id="a0bc53252d6deea62ee6029e971f5087a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc53252d6deea62ee6029e971f5087a">&#9670;&nbsp;</a></span>state_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">state state_start </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises elevator, queue and door modules. </p>
<p>Runs the initialisation functions for the elevator, queue and door modules.</p>
<dl class="section return"><dt>Returns</dt><dd>IDLE on successful initialisation. END if hardware initialisation fails. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="elevator_8h.html#a7ba7c2e8b5c4c2b9500a3057a9b14b5c" title="Initialises the elevator hardware.">elevator_init_hardware</a>, <a class="el" href="elevator_8h.html#adfe9cac4cc26b28abcc5311cf824a8a0" title="Initialises the elevator variables and moves the elevator downwards until it reaches a defined state.">elevator_init</a>, <a class="el" href="queue_8h.html#ac19ac10c04e65b54e2c03aa726d1535a" title="Initialises the variables in the queue module.">queue_init</a> and <a class="el" href="door_8h.html#a2d0de401f47aafdfe2dba172332748de" title="Initialises door module variables.">door_init</a> for more details. </dd></dl>

<p class="definition">Definition at line <a class="el" href="states_8c_source.html#l00014">14</a> of file <a class="el" href="states_8c_source.html">states.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
